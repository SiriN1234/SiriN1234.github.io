<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="출처 : 혼자 공부하는 머신러닝+딥러닝
합성곱 신경망
로지스틱 회귀 (일반 ML 모형) : 81% &amp;#x2F; 1950년대
인공신경망 (딥러닝 초기 모형) : 87% &amp;#x2F; 1940~80년대
합성곱(Convolution, CNN)
코드보다는 주요 용어 정리에 주력"/>
    

    <!--Author-->
    
        <meta name="author" content="SiriN"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Chapter 8장"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="출처 : 혼자 공부하는 머신러닝+딥러닝
합성곱 신경망
로지스틱 회귀 (일반 ML 모형) : 81% &amp;#x2F; 1950년대
인공신경망 (딥러닝 초기 모형) : 87% &amp;#x2F; 1940~80년대
합성곱(Convolution, CNN)
코드보다는 주요 용어 정리에 주력"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="SiriN&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://SiriN1234.github.ioimg/home-bg.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://SiriN1234.github.ioimg/home-bg.jpg"/>
    

    <!-- Title -->
    
    <title>Chapter 8장 - SiriN&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Configurable Title</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Chapter 8장</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Hanjeongin on
                        
                        
                            2022-04-10
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/Python/">#Python</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>출처 : 혼자 공부하는 머신러닝+딥러닝</p>
<h1 id="합성곱-신경망"><a href="#합성곱-신경망" class="headerlink" title="합성곱 신경망"></a>합성곱 신경망</h1><ul>
<li>로지스틱 회귀 (일반 ML 모형) : 81% &#x2F; 1950년대</li>
<li>인공신경망 (딥러닝 초기 모형) : 87% &#x2F; 1940~80년대</li>
<li>합성곱(Convolution, CNN)<ul>
<li>코드보다는 주요 용어 정리에 주력</li>
<li>발전사 : alexnet (2012) -&gt; resnet -&gt; efficientnet</li>
<li>채널, 이미지의 너비, 크기 (파라미터 튜닝)</li>
<li>Vision Transformer</li>
</ul>
</li>
<li>비디오<ul>
<li>객체인식(Object Detection)</li>
<li>Yolo 논문</li>
</ul>
</li>
<li>RNN &#x2F; LSTM (자연어 처리)<ul>
<li>구글에서 2017년에 Transformer 논문 발표</li>
</ul>
</li>
</ul>
<h1 id="합성곱의-장점"><a href="#합성곱의-장점" class="headerlink" title="합성곱의 장점"></a>합성곱의 장점</h1><ul>
<li>기존 : 1차원 배열에서만 연산이 가능</li>
<li>2차원 배열에도 연산을 할 수 있도록 구현<ul>
<li>선형대수를 공부해야 함</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras
keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">'relu'</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>&lt;keras.layers.convolutional.Conv2D at 0x7fbe29416850&gt;
</code></pre>
<h2 id="패딩의-목적"><a href="#패딩의-목적" class="headerlink" title="패딩의 목적"></a>패딩의 목적</h2><ul>
<li>배열의 크기를 조정하더라도 이미지 원 특성이 손실되는 것을 방지하는 것</li>
</ul>
<pre class=" language-python"><code class="language-python">keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    activation <span class="token operator">=</span> <span class="token string">'relu'</span><span class="token punctuation">,</span>
                    padding <span class="token operator">=</span> <span class="token string">'same'</span><span class="token punctuation">,</span>
                    strides <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>&lt;keras.layers.convolutional.Conv2D at 0x7fbda5a1ffd0&gt;
</code></pre>
<h2 id="풀링"><a href="#풀링" class="headerlink" title="풀링"></a>풀링</h2><ul>
<li><p>값을 추출</p>
</li>
<li><p>100 x 100 이미지 –&gt; (수치로) 주요 이미지의 특성만 뽑은 후, 원 이미지와 같게 만듦 (50 x 50)</p>
</li>
<li><p>교재 437p</p>
</li>
<li><p>1단계 : 이미지 데이터 입력</p>
</li>
<li><p>2단계 : 합성곱 층</p>
<ul>
<li>(1) kernel_size + padding</li>
<li>(2) 활성화 함수 적용</li>
<li>(3) 각각의 특성맵을 산출</li>
</ul>
</li>
<li><p>3단계 : 풀링층</p>
<ul>
<li>(1) Max Pooling : 최댓값 추출</li>
<li>(2) 최종 특성맵 만듦</li>
</ul>
</li>
<li><p>위 과정을 계속 만복하는 것이 CNN 알고리즘</p>
</li>
</ul>
<h4 id="알고리즘"><a href="#알고리즘" class="headerlink" title="알고리즘"></a>알고리즘</h4><ul>
<li>4단계 : 밀집층 (Fully Connected Layer)<ul>
<li>Chapter 7장에서 이미 배움</li>
</ul>
</li>
<li>5단계 : 분류 예측값을 산출 (Softmax 활성화 함수)</li>
</ul>
<h4 id="주요-키워드-사전학습-Pretrained-x2F-전이학습-Transfer-Learning-x2F-파인-튜닝-Fine-Tuning"><a href="#주요-키워드-사전학습-Pretrained-x2F-전이학습-Transfer-Learning-x2F-파인-튜닝-Fine-Tuning" class="headerlink" title="주요 키워드 : 사전학습(Pretrained) &#x2F; 전이학습(Transfer Learning) &#x2F; 파인 튜닝(Fine Tuning)"></a>주요 키워드 : 사전학습(Pretrained) &#x2F; 전이학습(Transfer Learning) &#x2F; 파인 튜닝(Fine Tuning)</h4><ul>
<li>캐글 경진대회</li>
<li>클래스 공부 필수</li>
</ul>
<h1 id="키워드로-끝내는-핵심-포인트"><a href="#키워드로-끝내는-핵심-포인트" class="headerlink" title="키워드로 끝내는 핵심 포인트"></a>키워드로 끝내는 핵심 포인트</h1><ul>
<li><strong>합성곱</strong>은 밀집층과 비슷하게 입력과 가중치를 곱하고 절편을 더하는 선형 계산입니다. 하지만 밀집층과 달리 각 합성곱은 입력 전체가 아니라 일부만 사용하여 선형 계산을 수행합니다.</li>
<li>합성곱 층의 <strong>필터</strong>는 밀집층의 뉴런에 해당합니다. 필터의 가중치와 절편을 종종 커널이라고 부릅니다. 자주 사용되는 커널의 크기는 (3, 3) 또는 (5, 5)입니다. 커널의 깊이는 입력의 깊이와 같습니다</li>
<li><strong>특성 맵</strong>은 합성곱 층이나 풀링 층의 출력 배열을 의미합니다. 필터 하나가 하나의 특성 맵을 만듭니다. 합성곱 층에서 5개의 필터를 적용하면 5개의 특성 맵이 만들어집니다.</li>
<li><strong>패딩</strong>은 합성곱 층의 입력 주위에 추가한 0으로 채워진 픽셀입니다. 패딩을 사용하지 않는 것을 밸리드 패딩이라고 합니다. 합성곱 층의 출력 크기를 입력과 동일하게 만들기 위해 입력에 패딩을 추가하는 것을 세임 패딩이라고 합니다.</li>
<li><strong>스트라이드</strong>는 합성곱 층에서 필터가 입력 위를 이동하는 크기입니다. 일반적으로 스트라이드는 1픽셀을 사용합니다.</li>
<li><strong>풀링</strong>은 가중치가 없고 특성 맵의 가로세로 크기를 줄이는 역할을 수행합니다. 대표적으로 최대 풀링과 평균 풀링이 있으며 (2, 2) 풀링으로 입력을 절반으로 줄입니다.</li>
</ul>
<h1 id="패션-MNIST-데이터-불러오기"><a href="#패션-MNIST-데이터-불러오기" class="headerlink" title="패션 MNIST 데이터 불러오기"></a>패션 MNIST 데이터 불러오기</h1><ul>
<li>데이터 스케일을 0에서 255사이 0~1로 표준화</li>
<li>훈련 데이터 &#x2F; 검증 데이터 분류</li>
<li>완전 연결 신경망(Fully Connected Layer)</li>
<li>-&gt; 2차원 배열을 1차원 배열로 만들어 줘야 함 (최종 분류 값 도출)</li>
<li>-&gt; 합성곱에서는 2차원 이미지를 그대로 사용한다</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test_input<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span> <span class="token operator">=</span> \
    keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>fashion_mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>

train_scaled <span class="token operator">=</span> train_input<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>

train_scaled<span class="token punctuation">,</span> val_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> val_target <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>
    train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
32768/29515 [=================================] - 0s 0us/step
40960/29515 [=========================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
26427392/26421880 [==============================] - 1s 0us/step
26435584/26421880 [==============================] - 1s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
16384/5148 [===============================================================================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
4423680/4422102 [==============================] - 0s 0us/step
4431872/4422102 [==============================] - 0s 0us/step
</code></pre>
<h1 id="합성곱-신경망-만들기"><a href="#합성곱-신경망-만들기" class="headerlink" title="합성곱 신경망 만들기"></a>합성곱 신경망 만들기</h1><pre class=" language-python"><code class="language-python">model <span class="token operator">=</span> keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 합성곱 층</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">'relu'</span><span class="token punctuation">,</span>
                              padding <span class="token operator">=</span> <span class="token string">'same'</span><span class="token punctuation">,</span> input_shape <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 풀링층</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>MaxPooling2D<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 합성곱 층</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> activation <span class="token operator">=</span> <span class="token string">'relu'</span><span class="token punctuation">,</span>
                              padding <span class="token operator">=</span> <span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 풀링층</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>MaxPooling2D<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 완전연결층 (밀집층 = Fully Connected Layer)</span>
<span class="token comment" spellcheck="true"># Chapter 7장 내용</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>Model: &quot;sequential&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 28, 28, 32)        320       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 14, 14, 32)       0         
 )                                                               
                                                                 
 conv2d_1 (Conv2D)           (None, 14, 14, 64)        18496     
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 7, 7, 64)         0         
 2D)                                                             
                                                                 
 flatten (Flatten)           (None, 3136)              0         
                                                                 
 dense (Dense)               (None, 100)               313700    
                                                                 
 dropout (Dropout)           (None, 100)               0         
                                                                 
 dense_1 (Dense)             (None, 10)                1010      
                                                                 
=================================================================
Total params: 333,526
Trainable params: 333,526
Non-trainable params: 0
_________________________________________________________________
</code></pre>
<pre class=" language-python"><code class="language-python">keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>plot_model<span class="token punctuation">(</span>model<span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_12_0.png" alt="png"></p>
<pre class=" language-python"><code class="language-python">keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>plot_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> show_shapes <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_13_0.png" alt="png"></p>
<ul>
<li>지금까지 한 것은 모델 정의</li>
<li>모델 컴파일 후, 훈련</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'sparse_categorical_crossentropy'</span><span class="token punctuation">,</span> 
              metrics<span class="token operator">=</span><span class="token string">'accuracy'</span><span class="token punctuation">)</span>

checkpoint_cb <span class="token operator">=</span> keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span><span class="token string">'best-cnn-model.h5'</span><span class="token punctuation">,</span> 
                                                save_best_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
early_stopping_cb <span class="token operator">=</span> keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>EarlyStopping<span class="token punctuation">(</span>patience<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                                                  restore_best_weights<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'/device:GPU:0'</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
  history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
                      validation_data<span class="token operator">=</span><span class="token punctuation">(</span>val_scaled<span class="token punctuation">,</span> val_target<span class="token punctuation">)</span><span class="token punctuation">,</span>
                      callbacks<span class="token operator">=</span><span class="token punctuation">[</span>checkpoint_cb<span class="token punctuation">,</span> early_stopping_cb<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>Epoch 1/20
1500/1500 [==============================] - 66s 43ms/step - loss: 0.5132 - accuracy: 0.8163 - val_loss: 0.3227 - val_accuracy: 0.8805
Epoch 2/20
1500/1500 [==============================] - 64s 43ms/step - loss: 0.3438 - accuracy: 0.8779 - val_loss: 0.2842 - val_accuracy: 0.8943
Epoch 3/20
1500/1500 [==============================] - 93s 62ms/step - loss: 0.2999 - accuracy: 0.8926 - val_loss: 0.2559 - val_accuracy: 0.9061
Epoch 4/20
1500/1500 [==============================] - 64s 42ms/step - loss: 0.2655 - accuracy: 0.9027 - val_loss: 0.2403 - val_accuracy: 0.9115
Epoch 5/20
1500/1500 [==============================] - 62s 41ms/step - loss: 0.2438 - accuracy: 0.9104 - val_loss: 0.2277 - val_accuracy: 0.9158
Epoch 6/20
1500/1500 [==============================] - 62s 42ms/step - loss: 0.2243 - accuracy: 0.9173 - val_loss: 0.2249 - val_accuracy: 0.9192
Epoch 7/20
1500/1500 [==============================] - 62s 42ms/step - loss: 0.2020 - accuracy: 0.9245 - val_loss: 0.2255 - val_accuracy: 0.9186
Epoch 8/20
1500/1500 [==============================] - 62s 42ms/step - loss: 0.1867 - accuracy: 0.9296 - val_loss: 0.2231 - val_accuracy: 0.9216
Epoch 9/20
1500/1500 [==============================] - 63s 42ms/step - loss: 0.1755 - accuracy: 0.9351 - val_loss: 0.2309 - val_accuracy: 0.9183
Epoch 10/20
1500/1500 [==============================] - 63s 42ms/step - loss: 0.1620 - accuracy: 0.9390 - val_loss: 0.2203 - val_accuracy: 0.9235
Epoch 11/20
1500/1500 [==============================] - 63s 42ms/step - loss: 0.1516 - accuracy: 0.9429 - val_loss: 0.2230 - val_accuracy: 0.9240
Epoch 12/20
1500/1500 [==============================] - 64s 42ms/step - loss: 0.1406 - accuracy: 0.9466 - val_loss: 0.2550 - val_accuracy: 0.9187
</code></pre>
<ul>
<li>모델 학습 곡선 그리기</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'epoch'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token string">'val'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_17_0.png" alt="png"></p>
<ul>
<li>google colab에서 GPU 확인</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

device_name <span class="token operator">=</span> tf<span class="token punctuation">.</span>test<span class="token punctuation">.</span>gpu_device_name<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> device_name <span class="token operator">!=</span> <span class="token string">'/device:GPU:0'</span><span class="token punctuation">:</span>
  <span class="token keyword">raise</span> SystemError<span class="token punctuation">(</span><span class="token string">'GPU device not found'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Found GPU at: &amp;#123;&amp;#125;'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>device_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>Found GPU at: /device:GPU:0
</code></pre>
<h1 id="합성곱-신경망-시각화"><a href="#합성곱-신경망-시각화" class="headerlink" title="합성곱 신경망 시각화"></a>합성곱 신경망 시각화</h1><ul>
<li>교재 465p</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras

<span class="token comment" spellcheck="true"># 사전학습 진행</span>
model <span class="token operator">=</span> keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>load_model<span class="token punctuation">(</span><span class="token string">"best-cnn-model.h5"</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># keras.utils.plot_model(model, show_shapes = True)</span>
model<span class="token punctuation">.</span>layers
</code></pre>
<pre><code>[&lt;keras.layers.convolutional.Conv2D at 0x7f7e70529850&gt;,
 &lt;keras.layers.pooling.MaxPooling2D at 0x7f7d84ea1390&gt;,
 &lt;keras.layers.convolutional.Conv2D at 0x7f7e705088d0&gt;,
 &lt;keras.layers.pooling.MaxPooling2D at 0x7f7e7052bfd0&gt;,
 &lt;keras.layers.core.flatten.Flatten at 0x7f7d84545850&gt;,
 &lt;keras.layers.core.dense.Dense at 0x7f7df7dd2910&gt;,
 &lt;keras.layers.core.dropout.Dropout at 0x7f7df7db9690&gt;,
 &lt;keras.layers.core.dense.Dense at 0x7f7e705a2210&gt;]
</code></pre>
<ul>
<li>합성곱 층의 가중치를 확인 가능</li>
</ul>
<pre class=" language-python"><code class="language-python">conv <span class="token operator">=</span> model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>conv<span class="token punctuation">.</span>weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">,</span> conv<span class="token punctuation">.</span>weights<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
<pre><code>(3, 3, 1, 32) (32,)
</code></pre>
<pre class=" language-python"><code class="language-python">conv_weights <span class="token operator">=</span> conv<span class="token punctuation">.</span>weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>conv_weights<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> conv_weights<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>-0.029388867 0.27234086
</code></pre>
<pre class=" language-python"><code class="language-python">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>conv_weights<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'weight'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_25_0.png" alt="png"></p>
<ul>
<li>교재 468p</li>
</ul>
<pre class=" language-python"><code class="language-python">fig<span class="token punctuation">,</span> axs <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>conv_weights<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token operator">*</span><span class="token number">16</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> vmax<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_27_0.png" alt="png"></p>
<pre class=" language-python"><code class="language-python">no_training_model <span class="token operator">=</span> keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>

no_training_model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> 
                                          padding<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre class=" language-python"><code class="language-python">no_training_conv <span class="token operator">=</span> no_training_model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>no_training_conv<span class="token punctuation">.</span>weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
<pre><code>(3, 3, 1, 32)
</code></pre>
<pre class=" language-python"><code class="language-python">no_training_weights <span class="token operator">=</span> no_training_conv<span class="token punctuation">.</span>weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>no_training_weights<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> no_training_weights<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>-0.0010502868 0.08291164
</code></pre>
<pre class=" language-python"><code class="language-python">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>no_training_weights<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'weight'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_31_0.png" alt="png"></p>
<pre class=" language-python"><code class="language-python">fig<span class="token punctuation">,</span> axs <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>no_training_weights<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token operator">*</span><span class="token number">16</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> vmax<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_32_0.png" alt="png"></p>
<h1 id="함수형-API"><a href="#함수형-API" class="headerlink" title="함수형 API"></a>함수형 API</h1><ul>
<li>474p</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>input<span class="token punctuation">)</span>
conv_acti <span class="token operator">=</span> keras<span class="token punctuation">.</span>Model<span class="token punctuation">(</span>model<span class="token punctuation">.</span>input<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>output<span class="token punctuation">)</span>
<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test_input<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span> <span class="token operator">=</span> keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>fashion_mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>train_input<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'gray_r'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>KerasTensor(type_spec=TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name=&#39;conv2d_input&#39;), name=&#39;conv2d_input&#39;, description=&quot;created by layer &#39;conv2d_input&#39;&quot;)
</code></pre>
<p><img src="/images/Chapter_8/output_34_1.png" alt="png"></p>
<pre class=" language-python"><code class="language-python">inputs <span class="token operator">=</span> train_input<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255.0</span>
feature_maps <span class="token operator">=</span> conv_acti<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>feature_maps<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
<pre><code>(1, 28, 28, 32)
</code></pre>
<pre class=" language-python"><code class="language-python">fig<span class="token punctuation">,</span> axs <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>feature_maps<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token operator">*</span><span class="token number">8</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_8/output_36_0.png" alt="png"></p>
<pre class=" language-python"><code class="language-python">conv2_acti <span class="token operator">=</span> keras<span class="token punctuation">.</span>Model<span class="token punctuation">(</span>model<span class="token punctuation">.</span>input<span class="token punctuation">,</span> model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>output<span class="token punctuation">)</span>
feature_maps <span class="token operator">=</span> conv2_acti<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>train_input<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255.0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>feature_maps<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

fig<span class="token punctuation">,</span> axs <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>feature_maps<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token operator">*</span><span class="token number">8</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span>
        axs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>(1, 14, 14, 64)
</code></pre>
<p><img src="/images/Chapter_8/output_37_1.png" alt="png"></p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/klugjo/hexo-theme-clean-blog" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2022 SiriN<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>