<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="출처 : 혼자 공부하는 머신러닝+딥러닝
데이터 불러오기
와인 데이터
alcohol(알코올 도수), sugar(당도), pH(산도)
클래스 0 &amp;#x3D; 레드 와인
클래스 1 &amp;#x3D; 화이트 와인



import pandas as pd

wine = pd.read"/>
    

    <!--Author-->
    
        <meta name="author" content="SiriN"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Chapter 5장"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="출처 : 혼자 공부하는 머신러닝+딥러닝
데이터 불러오기
와인 데이터
alcohol(알코올 도수), sugar(당도), pH(산도)
클래스 0 &amp;#x3D; 레드 와인
클래스 1 &amp;#x3D; 화이트 와인



import pandas as pd

wine = pd.read"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="SiriN&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://SiriN1234.github.ioimg/home-bg.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://SiriN1234.github.ioimg/home-bg.jpg"/>
    

    <!-- Title -->
    
    <title>Chapter 5장 - SiriN&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Configurable Title</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Chapter 5장</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Hanjeongin on
                        
                        
                            2022-03-30
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/Python/">#Python</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>출처 : 혼자 공부하는 머신러닝+딥러닝</p>
<h1 id="데이터-불러오기"><a href="#데이터-불러오기" class="headerlink" title="데이터 불러오기"></a>데이터 불러오기</h1><ul>
<li>와인 데이터<ul>
<li>alcohol(알코올 도수), sugar(당도), pH(산도)</li>
<li>클래스 0 &#x3D; 레드 와인</li>
<li>클래스 1 &#x3D; 화이트 와인</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

wine <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'https://bit.ly/wine_csv_data'</span><span class="token punctuation">)</span>

wine<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
  <div id="df-288300f0-c1b2-4028-8df7-21b3a2cfa4a6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>sugar</th>
      <th>pH</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.4</td>
      <td>1.9</td>
      <td>3.51</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.8</td>
      <td>2.6</td>
      <td>3.20</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.8</td>
      <td>2.3</td>
      <td>3.26</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.8</td>
      <td>1.9</td>
      <td>3.16</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.4</td>
      <td>1.9</td>
      <td>3.51</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-288300f0-c1b2-4028-8df7-21b3a2cfa4a6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-288300f0-c1b2-4028-8df7-21b3a2cfa4a6 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-288300f0-c1b2-4028-8df7-21b3a2cfa4a6&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>info()<ul>
<li>결측치 확인 &#x2F; 변수타입</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python">wine<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6497 entries, 0 to 6496
Data columns (total 4 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   alcohol  6497 non-null   float64
 1   sugar    6497 non-null   float64
 2   pH       6497 non-null   float64
 3   class    6497 non-null   float64
dtypes: float64(4)
memory usage: 203.2 KB
</code></pre>
<ul>
<li>describe()<ul>
<li>열에 대한 간략한 통계를 출력해 줌</li>
<li>평균, 표준편차, 최소, 최대, 사분위수에 대해 알 수 있음</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python">wine<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
  <div id="df-1cdc8b8a-2553-4905-b2da-cc82a9d4416b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>sugar</th>
      <th>pH</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6497.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>10.491801</td>
      <td>5.443235</td>
      <td>3.218501</td>
      <td>0.753886</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.192712</td>
      <td>4.757804</td>
      <td>0.160787</td>
      <td>0.430779</td>
    </tr>
    <tr>
      <th>min</th>
      <td>8.000000</td>
      <td>0.600000</td>
      <td>2.720000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>9.500000</td>
      <td>1.800000</td>
      <td>3.110000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10.300000</td>
      <td>3.000000</td>
      <td>3.210000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>11.300000</td>
      <td>8.100000</td>
      <td>3.320000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>14.900000</td>
      <td>65.800000</td>
      <td>4.010000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1cdc8b8a-2553-4905-b2da-cc82a9d4416b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-1cdc8b8a-2553-4905-b2da-cc82a9d4416b button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-1cdc8b8a-2553-4905-b2da-cc82a9d4416b&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>알코올 도수와 당도, pH 값으 스케일이 다름</li>
<li>표준화가 필요함</li>
</ul>
<h1 id="표준화-작업"><a href="#표준화-작업" class="headerlink" title="표준화 작업"></a>표준화 작업</h1><ul>
<li>판다스 데이터프레임을 넘파일 배열로 바꿔 줌</li>
</ul>
<pre class=" language-python"><code class="language-python">data <span class="token operator">=</span> wine<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
target <span class="token operator">=</span> wine<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h1 id="훈련-데이터와-테스트-데이터로-분리"><a href="#훈련-데이터와-테스트-데이터로-분리" class="headerlink" title="훈련 데이터와 테스트 데이터로 분리"></a>훈련 데이터와 테스트 데이터로 분리</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

train_input<span class="token punctuation">,</span> test_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span>
<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># test_size는 훈련데이터와 테스트데이터 비율을 8:2로 나눈 것</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>train_input<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> test_input<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
<pre><code>(5197, 3) (1300, 3)
</code></pre>
<ul>
<li>train_test_split() 함수는 설정값을 지정하지 않으면 25%를 테스트 세트로 지정 함</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler

ss <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
ss<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">)</span>
train_scaled <span class="token operator">=</span> ss<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>train_input<span class="token punctuation">)</span>
test_scaled <span class="token operator">=</span> ss<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>test_input<span class="token punctuation">)</span>
</code></pre>
<h1 id="모델-만들기"><a href="#모델-만들기" class="headerlink" title="모델 만들기"></a>모델 만들기</h1><h2 id="로지스틱회귀"><a href="#로지스틱회귀" class="headerlink" title="로지스틱회귀"></a>로지스틱회귀</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression
lr <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
lr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lr<span class="token punctuation">.</span>score<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lr<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_scaled<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lr<span class="token punctuation">.</span>coef_<span class="token punctuation">,</span> lr<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>
</code></pre>
<pre><code>0.7808350971714451
0.7776923076923077
[[ 0.51270274  1.6733911  -0.68767781]] [1.81777902]
</code></pre>
<ul>
<li>로지스틱 회귀 모델로는 다른 사람에게 살명하기 어려움</li>
<li>설명하기 쉬운 모델이 필요함</li>
</ul>
<h2 id="의사결정트리"><a href="#의사결정트리" class="headerlink" title="의사결정트리"></a>의사결정트리</h2><ul>
<li>질문을 하나씩 던져서 예 아니오로 분류를 함</li>
<li>계숙 질문을 추가해서 분류 정확도를 높이는 방식</li>
</ul>
<p>의사결정트리는 1975년도 최초등장</p>
<ul>
<li>다양한 산업에서 많이 쓰임</li>
</ul>
<p>2001년 즈음 랜덤 포레스트</p>
<ul>
<li>캐글 대회</li>
<li>2017~8년까지 정형데이터 대회는 랜덤포레스트가 메인 이론</li>
<li>치명적인 단점은 과적합이 잘 발생함</li>
<li>숫자에 민감하지 않음</li>
<li>표준화를 해줄 필요가 없음</li>
</ul>
<p>로지스틱 회귀</p>
<ul>
<li>수식 -&gt; 숫자에 민감</li>
<li>표준화 필요</li>
</ul>
<p>의사결정트리의 기본 알고리즘을 활용해서, MS, 구글 등 이런 회사들이 신규 알고리즘을 만듦</p>
<ul>
<li>XGBoost, LightGBM, CatBoost</li>
<li>캐글 정형데이터</li>
<li>LightGBM(지금현재 실무에서 많이 쓰임)<ul>
<li>4월 말까지는 코드에 집중</li>
<li>PPT(알고리즘 소개)</li>
<li>LightGBM을 쓰려면 의사결정트리와 경사하강법에 대해서 알아야 됨</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
dt <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 훈련 세트</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_scaled<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 테스트 세트</span>
</code></pre>
<pre><code>0.996921300750433
0.8592307692307692
</code></pre>
<ul>
<li>성능보다 안정적인게 중요함</li>
<li>테스트스코어를 올리는 것 보다 훈련스코어를 내리는게 더 쉬움</li>
<li>그래서 훈련스코어를 낮추는 편</li>
</ul>
<h2 id="시각화"><a href="#시각화" class="headerlink" title="시각화"></a>시각화</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> plot_tree

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dt<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_5/output_23_0.png" alt="png"></p>
<ul>
<li>이대로 보기에는 너무 복잡함</li>
<li>plot_tree() 함수에서 트리의 깊이를 제한해서 출력</li>
<li>max_dapth를 통해 가능</li>
<li>filled 매게변수에서 클래스에 맞게 노드의 색을 칠할 수 있음</li>
</ul>
<pre class=" language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> max_depth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> filled <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_5/output_25_0.png" alt="png"></p>
<ul>
<li>gini는 불순도</li>
<li>질문을 통해서 걸러냄</li>
<li>value에서 왼쪽이 조건 만족의 갯수, 오른쪽은 조건 불만족</li>
<li>지니 불순도 &#x3D; 1 - (음성 클래스 비율 ^ 2 + 양성 클래스 비율 ^ 2)</li>
<li>결정 트리 모델은 부모 노드와 자식 노드의 불순도 차이가 가능한 크도록 트리를 성장시킴</li>
<li>부모와 자식 노드 사이의 불순도 차이를 **정보 이득(information gain)**이라고 부름</li>
</ul>
<h1 id="가지치기"><a href="#가지치기" class="headerlink" title="가지치기"></a>가지치기</h1><ul>
<li>과대적합을 방지하기 위한 것</li>
<li>결정 트리에서 가지치기를 하는 가장 간단한 방법은 자라날 수 있는 트리의 최대 깊이를 지정하는 것</li>
</ul>
<pre class=" language-python"><code class="language-python">dt <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>train_scaled<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_scaled<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8454877814123533
0.8415384615384616
</code></pre>
<ul>
<li>훈련 세트의 성능은 낮아졌지만 테스트 세트의 성능은 거의 그대로</li>
<li>안정성이 높아짐</li>
</ul>
<pre class=" language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> filled <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_5/output_30_0.png" alt="png"></p>
<h2 id="시각화-해석"><a href="#시각화-해석" class="headerlink" title="시각화 해석"></a>시각화 해석</h2><ul>
<li>당도가 -0.802보다 크고 -0.239보다 작은 와인 중에 알코올 도수가 0.454와 같거나 작은 것이 레드와인</li>
<li>설명하기 이상함</li>
</ul>
<h2 id="의사결정트리의-특징"><a href="#의사결정트리의-특징" class="headerlink" title="의사결정트리의 특징"></a>의사결정트리의 특징</h2><ul>
<li>샘플을 어떤 클래스 비율로 나누는지 계산할 때 특성값의 스케일이 계산에 영향을 미치지 않음</li>
<li>따라서 표준화 전처리를 할 필요가 없음</li>
<li>전처리하기 전의 훈련 세트와 테스트 세트로 결정트리 모델을 훈련</li>
</ul>
<pre class=" language-python"><code class="language-python">dt <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_input<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8454877814123533
0.8415384615384616
</code></pre>
<h2 id="시각화-1"><a href="#시각화-1" class="headerlink" title="시각화"></a>시각화</h2><pre class=" language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> filled <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_5/output_35_0.png" alt="png"></p>
<h2 id="시각화-해석-1"><a href="#시각화-해석-1" class="headerlink" title="시각화 해석"></a>시각화 해석</h2><ul>
<li>특성값을 표준점수로 바꾸지 않아서 이해하기 훨씬 쉬움</li>
<li>당도가 1.625보다 크고 4.325보다 작은 와인 중에 알코올 도수가 11.025와 같거나 작은 것이 레드 와인, 그 외에는 화이트 와인으로 예측</li>
</ul>
<h2 id="특성-중요도"><a href="#특성-중요도" class="headerlink" title="특성 중요도"></a>특성 중요도</h2><ul>
<li>결정 트리는 어떤 특성이 가장 유용한지 나타내는 특성 중요도를 계산해 줌</li>
<li>이 트리의 루트 노드와 깊이 1에서 당도를 사용했기 때문에 아마도 당도(sugar)가 가장 유용한 특성 중 하나 일 것이라 예상</li>
<li>특성 중요도는 feature_importances_ 속성에 저장되어 있음</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>feature_importances_<span class="token punctuation">)</span>
</code></pre>
<pre><code>[0.12345626 0.86862934 0.0079144 ]
</code></pre>
<ul>
<li>알콜이 12%정도, 당도가 87%정도, 나머지는 산도</li>
<li>당도의 특성 중요도가 가장 높음</li>
</ul>
<h1 id="마무리"><a href="#마무리" class="headerlink" title="마무리"></a>마무리</h1><h2 id="키워드로-끝내는-핵심-포인트"><a href="#키워드로-끝내는-핵심-포인트" class="headerlink" title="키워드로 끝내는 핵심 포인트"></a>키워드로 끝내는 핵심 포인트</h2><ul>
<li><strong>결정 트리</strong>는 예 &#x2F; 아니오에 대한 질문을 이어나가면서 정답을 찾아 학습하는 알고리즘입니다. 비교적 예측 과정을 이해하기 쉽고 성능도 뛰어납니다</li>
<li><strong>불순도</strong>는 결정 트리가 최적의 질문을 찾기 위한 기준입니다. 사이킷런은 지니 불순도와 엔트로피 불순도를 제공합니다.</li>
<li><strong>정보 이득</strong>은 부모 노드와 자식 노드의 불순도 차이입니다. 결정 트리 알고리즘은 정보 이득이 최대화되도록 학습합니다.</li>
<li>** 결정 트리는 제한 없이 성장하면 훈련 세트에 과대적합되기 쉽습니다. <strong>가지치기</strong>는 결정 트리의 성장을 제한하는 방법입니다. 사이킷런의 결정 트리 알고리즘은 여러가지 가지치기 매개변수를 제공합니다</li>
<li><strong>특성 중요도</strong>는 결정 트리에 사용된 특성이 불순도를 감수하는데 기여한 정도를 나타내는 값입니다. 특성 중요도를 계산할 수 있는 것이 결정 트리의 또다른 큰 장점입니다.</li>
</ul>
<h2 id="핵심-패키지와-함수"><a href="#핵심-패키지와-함수" class="headerlink" title="핵심 패키지와 함수"></a>핵심 패키지와 함수</h2><h3 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h3><ul>
<li>**info()**는 데이터프레임의 요약된 정보를 출력합니다. 인덱스와 컬럼 타입을 출력하고 널(null)이 아닌 값으 개수, 메모리 사용량을 제공합니다. verbose 매개변수의 기본값 True를 False로 바꾸면 각 열에 대한 정보를 출력하지 않습니다.</li>
<li>**describe()**는 데이터프레임의 열의 통계 값을 제공합니다.<ul>
<li>수치형일 경우 최소, 최대, 평균, 표준편차와 사분위값 등이 출력됩니다.</li>
<li>문자열 같은 객체 타입의 열은 가장 자주 등장하는 값과 횟수 등이 출력됩니다.</li>
<li>percentiles 매개변수에서 백분위수를 지정합니다. 기본값은 [0.25, .5, 0.75]입니다.</li>
</ul>
</li>
</ul>
<h3 id="scikit-learn"><a href="#scikit-learn" class="headerlink" title="scikit-learn"></a>scikit-learn</h3><ul>
<li><p><strong>DecisionTreeClassifier</strong>는 결정 트리 분류 클래스입니다.</p>
<ul>
<li>criterion 매개변수는 불순도를 지정하며 기본값은 지니 불순도를 의미하는 ‘gini’이고 ‘entropy’를 선택하여 엔트로피 불순도를 사용할 수 있습니다.</li>
<li>splitter 매개변수는 노드를 분할하는 전략을 선택합니다. 기본값은 ‘best’로 정보 이득이 최대가 되도록 분할합니다. ‘random’이면 임의로 노드를 분할합니다.</li>
<li>max_depth는 트리가 성장할 최대 깊이를 지정합니다. 기본값은 None으로 리프 노드가 순수하거나 min_samples_split보다 샘플 개수가 적을 때까지 성장합니다.</li>
<li>min_samples_split은 노드를 나누기 위한 최소 샘플의 개수입니다. 기본값은 2입니다.</li>
<li>max_features 매개변수는 최적의 분할을 위해 탐색할 특성의 개수를 지정합니다. 기본값은 None으로 모든 특성을 사용합니다.</li>
</ul>
</li>
<li><p>**plot_tree()**는 결정 트리 모델을 시각화합니다. 첫 번째 매개변수로 결정 트리 모델 객체를 전달합니다.</p>
<ul>
<li>max_depth 매개변수로 나타낼 트리의 깊이를 지정합니다. 기본값은 None으로 모든 노드를 출력합니다.</li>
<li>feature_names 매개변수로 특성의 이름을 지정할 수 있습니다.</li>
<li>filled 매개변수를 True로 지정하면 타깃값에 따라 노드 안에 색을 채웁니다.</li>
</ul>
</li>
</ul>
<h1 id="확인문제-3번-코드-테스트"><a href="#확인문제-3번-코드-테스트" class="headerlink" title="확인문제 3번 코드 테스트"></a>확인문제 3번 코드 테스트</h1><ul>
<li>min_impurity_decrease를 사용해서 가지치기 해보기</li>
<li>(노드의 정보 이득) * (노드의 샘플 수) &#x2F; (전체 샘플 수) 값이 min_impurity_decrease보다 작으면 더 이상 분할하지 않음</li>
</ul>
<pre class=" language-python"><code class="language-python">dt <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>min_impurity_decrease <span class="token operator">=</span> <span class="token number">0.0005</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_input<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> filled <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8874350586877044
0.8615384615384616
</code></pre>
<p><img src="/images/Chapter_5/output_44_1.png" alt="png"></p>
<ul>
<li>훈련 데이터 스코어와 테스트 데이터 스코어 값이 비슷함</li>
<li>안정성이 높음</li>
<li>전체적으로 성능도 좋은 편</li>
</ul>
<h1 id="png-파일로-시각화"><a href="#png-파일로-시각화" class="headerlink" title="png 파일로 시각화"></a>png 파일로 시각화</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> graphviz
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> tree

<span class="token comment" spellcheck="true"># DOT data</span>
dot_data <span class="token operator">=</span> tree<span class="token punctuation">.</span>export_graphviz<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> out_file<span class="token operator">=</span>None<span class="token punctuation">,</span> 
                                feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
                                filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Draw graph</span>
graph <span class="token operator">=</span> graphviz<span class="token punctuation">.</span>Source<span class="token punctuation">(</span>dot_data<span class="token punctuation">,</span> format<span class="token operator">=</span><span class="token string">"png"</span><span class="token punctuation">)</span> 
graph
</code></pre>
<p><img src="/images/Chapter_5/output_47_0.svg" alt="svg"></p>
<pre class=" language-python"><code class="language-python">graph<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"decision_tree_graphivz"</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>&#39;decision_tree_graphivz.png&#39;
</code></pre>
<h1 id="노드-색-바꾸기"><a href="#노드-색-바꾸기" class="headerlink" title="노드 색 바꾸기"></a>노드 색 바꾸기</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> ListedColormap<span class="token punctuation">,</span> to_rgb
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
artists <span class="token operator">=</span> plot_tree<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> filled <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> 
          feature_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> artist<span class="token punctuation">,</span> impurity<span class="token punctuation">,</span> value <span class="token keyword">in</span> zip<span class="token punctuation">(</span>artists<span class="token punctuation">,</span> dt<span class="token punctuation">.</span>tree_<span class="token punctuation">.</span>impurity<span class="token punctuation">,</span> dt<span class="token punctuation">.</span>tree_<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b <span class="token operator">=</span> to_rgb<span class="token punctuation">(</span>colors<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    f <span class="token operator">=</span> impurity <span class="token operator">*</span> <span class="token number">2</span>
    artist<span class="token punctuation">.</span>get_bbox_patch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>f<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">,</span> f <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>f<span class="token punctuation">)</span><span class="token operator">*</span>g<span class="token punctuation">,</span> f <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>f<span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    artist<span class="token punctuation">.</span>get_bbox_patch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_edgecolor<span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/images/Chapter_5/output_50_0.png" alt="png"></p>
<h1 id="교차-검증과-그리드-서치"><a href="#교차-검증과-그리드-서치" class="headerlink" title="교차 검증과 그리드 서치"></a>교차 검증과 그리드 서치</h1><ul>
<li>키워드 : 하이퍼파라미터 (그리드서치 vs 랜덤서치)</li>
<li>데이터가 작을 때, 주로 사용</li>
<li>하이퍼파라미터<ul>
<li>max_depth : 3, 정확도가 84%</li>
</ul>
</li>
<li>결론<ul>
<li>모르면 디폴트만 쓰자</li>
<li>가성비 (시간 대비 성능 보장 안됨)</li>
</ul>
</li>
</ul>
<h1 id="검증-세트"><a href="#검증-세트" class="headerlink" title="검증 세트"></a>검증 세트</h1><ul>
<li>테스트 세트 (1회성)</li>
<li>훈련 데이터를 훈련 데이터 + 검증 데이터로 재 분할</li>
</ul>
<h2 id="현실"><a href="#현실" class="headerlink" title="현실"></a>현실</h2><ul>
<li>테스트 데이터가 별도로 존재하지 않음</li>
<li>전체 데이터 &#x3D; 훈련 (6) : 검증 (2) : 테스트 (2)<ul>
<li>테스트 데이터는 모르는 데이터로 생각</li>
</ul>
</li>
</ul>
<h1 id="데이터-불러오기-1"><a href="#데이터-불러오기-1" class="headerlink" title="데이터 불러오기"></a>데이터 불러오기</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

wine <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'https://bit.ly/wine_csv_data'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> wine<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
target <span class="token operator">=</span> wine<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

train_input<span class="token punctuation">,</span> test_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span>
<span class="token punctuation">)</span>
</code></pre>
<ul>
<li>검증 세트 만들기</li>
</ul>
<pre class=" language-python"><code class="language-python">sub_input<span class="token punctuation">,</span> val_input<span class="token punctuation">,</span> sub_target<span class="token punctuation">,</span> val_target <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>
    train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span>
<span class="token punctuation">)</span>
</code></pre>
<pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>sub_input<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> val_input<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> test_input<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
<pre><code>(4157, 3) (1040, 3) (1300, 3)
</code></pre>
<h1 id="모델-만든-후-평가"><a href="#모델-만든-후-평가" class="headerlink" title="모델 만든 후 평가"></a>모델 만든 후 평가</h1><ul>
<li>과대적합 발생</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
dt <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>sub_input<span class="token punctuation">,</span> sub_target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>sub_input<span class="token punctuation">,</span> sub_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>val_input<span class="token punctuation">,</span> val_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.9971133028626413
0.864423076923077
</code></pre>
<h1 id="교차-검증"><a href="#교차-검증" class="headerlink" title="교차 검증"></a>교차 검증</h1><ul>
<li>교차 검증의 목적 : 좋은 모델이 만들어진다<ul>
<li>좋은 모델 !&#x3D; 성능 좋은 모델</li>
<li>좋은 모델 &#x3D; 과대적합이 아닌 모델 &#x3D; 모형의 오차가 적은 모델 &#x3D; 안정적인 모델</li>
</ul>
</li>
<li>교재 245p<ul>
<li>모델 평가 1 : 90% (소요시간 : 1시간)</li>
<li>모델 평가 2 : 85%</li>
<li>모델 평가 3 : 80%</li>
</ul>
</li>
<li>단점 : 시간이 오래 걸림</li>
</ul>
<h1 id="교차-검증-함수"><a href="#교차-검증-함수" class="headerlink" title="교차 검증 함수"></a>교차 검증 함수</h1><ul>
<li>사이킷런에 cross_validate()라는 교차 검증 함수 사용</li>
<li>먼저 평가할 모델 객체를 첫 번째 매개변수로 전달, 그 다음 훈련세트 전체를 cross_validate() 함수에 전달</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> cross_validate
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span>
</code></pre>
<pre><code>&#123;&#39;fit_time&#39;: array([0.02719903, 0.01022577, 0.01074076, 0.01042938, 0.0099504 ]), &#39;score_time&#39;: array([0.00116682, 0.00098372, 0.00113153, 0.00108194, 0.0010345 ]), &#39;test_score&#39;: array([0.86923077, 0.84615385, 0.87680462, 0.84889317, 0.83541867])&#125;
</code></pre>
<ul>
<li>최종점수 평균 구하기</li>
<li>검증 폴드의 점수임</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8574181117533719
</code></pre>
<ul>
<li>훈련 세트 섞은 후, 10-폴드 교차검증</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedKFold
splitter <span class="token operator">=</span> StratifiedKFold<span class="token punctuation">(</span>n_splits <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> shuffle <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>dt<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> cv <span class="token operator">=</span> splitter<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8574181117533719
</code></pre>
<h1 id="하이퍼파라미터-튜닝을-꼭-하고싶다면"><a href="#하이퍼파라미터-튜닝을-꼭-하고싶다면" class="headerlink" title="하이퍼파라미터 튜닝을 꼭 하고싶다면"></a>하이퍼파라미터 튜닝을 꼭 하고싶다면</h1><ul>
<li>랜덤 서치를 사용하자</li>
<li>자동으로 잡아주는 라이브러리들이 등장하기 시작함<ul>
<li>hyperopt</li>
</ul>
</li>
</ul>
<h2 id="그리드-서치"><a href="#그리드-서치" class="headerlink" title="그리드 서치"></a>그리드 서치</h2><ul>
<li>하이퍼파라미터 탐색과 교차 검증을 한 번에 수행함</li>
<li>별도로 cross_validate() 함수를 호출할 필요 없음</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV
params <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;'min_impurity_decrease' : [0.0001, 0.0002, 0.0003, 0.0004, 0.0005]&amp;#125;</span>

gs <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>DecisionTreeClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
gs<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
</code></pre>
<pre><code>GridSearchCV(estimator=DecisionTreeClassifier(random_state=42), n_jobs=-1,
             param_grid=&#123;&#39;min_impurity_decrease&#39;: [0.0001, 0.0002, 0.0003,
                                                   0.0004, 0.0005]&#125;)
</code></pre>
<ul>
<li>그리드 서치는 훈련이 끝나면 모델 중에서 검증 점수가 가장 높은 모델의 매개변수 조합으로 전체 훈련 세트에서 자도응로 다시 모델을 훈련 함</li>
<li>이 모델은 gs 객체의 best_estimator_ 속성에 저장되어 있음</li>
<li>그리드 서치로 찾은 최적의 매개변수는 best_params_ 속성에 저장되어 있음</li>
</ul>
<pre class=" language-python"><code class="language-python">dt <span class="token operator">=</span> gs<span class="token punctuation">.</span>best_estimator_
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gs<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span>
</code></pre>
<pre><code>DecisionTreeClassifier(min_impurity_decrease=0.0001, random_state=42)
0.9615162593804117
&#123;&#39;min_impurity_decrease&#39;: 0.0001&#125;
</code></pre>
<ul>
<li>교차 검증으로 얻은 점수 출력</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>gs<span class="token punctuation">.</span>cv_results_<span class="token punctuation">[</span><span class="token string">'mean_test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>[0.86819297 0.86453617 0.86492226 0.86780891 0.86761605]
</code></pre>
<h2 id="랜덤-서치"><a href="#랜덤-서치" class="headerlink" title="랜덤 서치"></a>랜덤 서치</h2><ul>
<li>252p</li>
<li>매개변수 값의 목록을 전달하는 것이 아니라 매개변수를 샘플링 할 수 있도록 확률 분포 객체를 전달</li>
<li>scipy는 파이썬의 핵심 과학 라이브러리 중 하나. 적분, 보간, 선형 대수, 확률 등을 포함한 수치 계산 전용 라이브러리.</li>
<li>uniform과 randint 클래스는 모두 주어진 범위에서 고르게 값을 뽑음</li>
<li>이를 ‘균등 군포에서 샘플링한다’라고 말 함</li>
<li>randint는 정수를 뽑고 uniform은 실수를 뽑음</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> uniform<span class="token punctuation">,</span> randint

rgen <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
rgen<span class="token punctuation">.</span>rvs<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>array([2, 7, 0, 3, 9, 2, 3, 7, 4, 4])
</code></pre>
<pre class=" language-python"><code class="language-python">np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>rgen<span class="token punctuation">.</span>rvs<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> return_counts <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]),
 array([ 96,  93, 105,  93, 105,  97,  87, 105, 113, 106]))
</code></pre>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> RandomizedSearchCV

<span class="token comment" spellcheck="true"># p.254</span>

params <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span>
    <span class="token string">'min_impurity_decrease'</span> <span class="token punctuation">:</span> uniform<span class="token punctuation">(</span><span class="token number">0.0001</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 0.0001에서 0.001 사이의 실숫값을 샘플링</span>
    <span class="token string">'max_depth'</span> <span class="token punctuation">:</span> randint<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 20에서 50 사이의 정수를 샘플링</span>
    <span class="token string">'min_samples_split'</span> <span class="token punctuation">:</span> randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 2에서 25 사이의 정수를 샘플링</span>
    <span class="token string">'min_samples_leaf'</span> <span class="token punctuation">:</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 1에서 25 사이의 정수를 샘플링</span>
<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span>

<span class="token comment" spellcheck="true"># params에 정의된 매개변수 범위에서 총 100번(n_iter 매개변수)을 샘플링하여 교차 검증을 수행하고, 최적의 매개변수 조합을 찾음</span>
gs <span class="token operator">=</span> RandomizedSearchCV<span class="token punctuation">(</span>DecisionTreeClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span>
                        n_iter <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>

gs<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
</code></pre>
<pre><code>RandomizedSearchCV(estimator=DecisionTreeClassifier(random_state=42),
                   n_iter=100, n_jobs=-1,
                   param_distributions=&#123;&#39;max_depth&#39;: &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7fed0d11b210&gt;,
                                        &#39;min_impurity_decrease&#39;: &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7fed0d11b2d0&gt;,
                                        &#39;min_samples_leaf&#39;: &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7fed0d14fe90&gt;,
                                        &#39;min_samples_split&#39;: &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7fed0d0f33d0&gt;&#125;,
                   random_state=42)
</code></pre>
<ul>
<li>최적의 매개변수 조합 출력</li>
</ul>
<pre class=" language-python"><code class="language-python">gs<span class="token punctuation">.</span>best_params_
</code></pre>
<pre><code>&#123;&#39;max_depth&#39;: 39,
 &#39;min_impurity_decrease&#39;: 0.00034102546602601173,
 &#39;min_samples_leaf&#39;: 7,
 &#39;min_samples_split&#39;: 13&#125;
</code></pre>
<h1 id="마무리-1"><a href="#마무리-1" class="headerlink" title="마무리"></a>마무리</h1><h2 id="키워드로-끝내는-핵심-포인트-1"><a href="#키워드로-끝내는-핵심-포인트-1" class="headerlink" title="키워드로 끝내는 핵심 포인트"></a>키워드로 끝내는 핵심 포인트</h2><ul>
<li><strong>검증 세트</strong>는 하이퍼파라미터 튜닝을 위해 모델을 평가할 때, 테스트 세트를 사용하지 않기 위해 훈련 세트에서 다시 떼어 낸 데이터 세트입니다.</li>
<li><strong>교차 검증</strong>은 훈련 세트를 여러 폴드로 나눈 다음 한 폴드가 검증 세트의 역할을 하고 나머지 폴드에서는 모델을 훈련합니다. 교차 검증은 이런 식으로 모든 폴드에 대해 검증 점수를 얻어 평균하는 방법입니다.</li>
<li><strong>그리드 서치</strong>는 하이퍼파라미터 탐색을 자동화해 주는 도구입니다. 탐색할 매개변수를 나열하면 교차 검증을 수행하여 가장 좋은 검증 점수의 매개변수 조합을 선택합니다. 마지막으로 이 매개변수 조합으로 최종 모델을 훈련합니다.</li>
<li>*랜덤 서치**는 연속된 매개변수 값을 탐색할 때 유용합니다. 탐색할 값을 직접 나열하는 것이 아니고 탐색 값을 샘플링할 수 있는 확률 분포 객체를 전달합니다. 지정된 횟수만큼 샘플링하여 교차 검증을 수행하기 때문에 시스템 자원이 허락하는 만큼 탐색량을 조절할 수 있습니다.</li>
</ul>
<h2 id="핵심-패키지와-함수-1"><a href="#핵심-패키지와-함수-1" class="headerlink" title="핵심 패키지와 함수"></a>핵심 패키지와 함수</h2><h3 id="scikit-learn-1"><a href="#scikit-learn-1" class="headerlink" title="scikit-learn"></a>scikit-learn</h3><ul>
<li><p>**cross_validate()**는 교차 검증을 수행하는 함수힙니다</p>
<ul>
<li>첫 번째 매개변수에 교차 검증을 수행할 무델 객체를 전달합니다. 두 번째와 세 번째 매개변수에 특성과 타깃 데이터를 전달합니다.</li>
<li>scoring 매개변수에 검증에 사용할 평가 지표를 지정할 수 있습니다. 기본적으로 분류 모델은 정확도를 의미하는 ‘accuracy’, 회귀 무델은 결정계수를 의미하는 ‘r2’가 됩니다.</li>
<li>cv 매개변수에 교차 검증 폴드 수나 스플리터 객체를 지정할 수 있습니다. 기본값은 5입니다. 회귀할 때는 KFold 클래스를 사용하고 분류일 때는 StratifiedKFold 클래스를 사용하여 5-폴드 교차 검증을 수행합니다</li>
<li>n_jobs 매개변수는 교차 검증을 수행할 때 사용할 CPU 코어 수를 지정합니다. 기본값은 1로 하나의 코어를 사용합니다. -1로 지정하면 시스템에 있는 모든 코어를 사용합니다.</li>
<li>return_train_score 매개변수를 True로 지정하면 훈련 세트의 점수도 반환합니다. 기본값은 False입니다.</li>
</ul>
</li>
<li><p><strong>GridSearchCV</strong>는 교차 검증으로 하이퍼파라미터 탐색을 수행합니다. 최상의 무델을 찾은 후 훈련 세트 전체를 사용해 최종 모델을 훈련합니다.</p>
<ul>
<li>첫 번째 매개변수로 그리드 서치를 수행할 모델 객체를 전달합니다. 두 번째 매개변수에는 탐색할 모델의 매개변수와 값을 전달합니다.</li>
<li>scoring, cv, n_jobs, return_train_score 매개변수는 cross_validate() 함수와 동일합니다.</li>
</ul>
</li>
<li><p><strong>RandomizedSearchCV</strong>는 교차 검증으로 랜덤한 하이퍼파라미터 탐색을 수행합니다. 최상의 무델을 찾은 후 훈련 세트 전체를 사용해 최종 모델을 훈련합니다.</p>
<ul>
<li>첫 번째 매개변수로 그리드 서치를 수행할 모델 객체를 전달합니다. 두 번째 매개변수에는 탐색할 모델의 매개변수와 확률 분포 객체를 전달합니다.</li>
<li>scoring, cv, n_jobs, return_train_score 매개변수는 cross_validate() 함수와 동일합니다.</li>
</ul>
</li>
</ul>
<h1 id="트리의-앙상블"><a href="#트리의-앙상블" class="headerlink" title="트리의 앙상블"></a>트리의 앙상블</h1><ul>
<li>LightGBM 기억<ul>
<li>GBM –&gt; XGBoost –&gt; LightGBM</li>
<li>참고 1. 모델 개발 속도가 빨라졌나</li>
<li>참고 2. 모델의 성능이 좋아졌나</li>
</ul>
</li>
<li>TabNet (2019)<ul>
<li>딥러닝 컨셉 이해 필요</li>
</ul>
</li>
</ul>
<h2 id="랜덤-포레스트"><a href="#랜덤-포레스트" class="headerlink" title="랜덤 포레스트"></a>랜덤 포레스트</h2><ul>
<li>결정 트리 나무를 500개 심기</li>
<li>최종적인 결정은 투표 방식<ul>
<li>나무-1 : 양성</li>
<li>나무-2 : 음성</li>
<li>나무-3 : 양성</li>
<li>…</li>
<li>나무-500 : 양성</li>
<li>합산해서 결과 도출</li>
</ul>
</li>
</ul>
<h1 id="데이터-불러오기-데이터-셋-분리"><a href="#데이터-불러오기-데이터-셋-분리" class="headerlink" title="데이터 불러오기, 데이터 셋 분리"></a>데이터 불러오기, 데이터 셋 분리</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

wine <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'https://bit.ly/wine_csv_data'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> wine<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'alcohol'</span><span class="token punctuation">,</span> <span class="token string">'sugar'</span><span class="token punctuation">,</span> <span class="token string">'pH'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
target <span class="token operator">=</span> wine<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

train_input<span class="token punctuation">,</span> test_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data<span class="token punctuation">,</span> 
                                                                      target<span class="token punctuation">,</span> 
                                                                      test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> 
                                                                      random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
</code></pre>
<ul>
<li>p. 267<ul>
<li>cross_validate() 교차 검증 수행</li>
<li>RandomForestClassifier는 기본적으로 100개의 결정 트리를 사용하므로 n_jobs 매개변수를 -1로 지정하여 모든 CPU 코어를 사용하는 것이 좋음</li>
<li>return_train_score 매개변수를 True로 지정하면 검증 점수뿐만 아니라 훈련 세트에 대한 점수도 같이 반환</li>
<li>훈련 세트와 검증 세트의 점수를 비교하면 과대적합을 파악하는데 용이함</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> cross_validate
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier

rf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>rf<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                        return_train_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'train_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.9973541965122431 0.8905151032797809
</code></pre>
<ul>
<li>과대적합</li>
<li>특성 중요도 출력</li>
</ul>
<pre class=" language-python"><code class="language-python">rf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rf<span class="token punctuation">.</span>feature_importances_<span class="token punctuation">)</span>
</code></pre>
<pre><code>[0.23167441 0.50039841 0.26792718]
</code></pre>
<ul>
<li>자체적으로 모델을 평가하는 점수를 얻을 수 있음</li>
<li>부트스트랩 샘플에 포함되지 않고 남는 샘플을 OOB 샘플이라 함</li>
<li>OOB 샘플을 사용하여 부트스트랩 샘플로 훈련한 결정 트리를 평가할 수 있음</li>
<li>oob_score 매개변수를 True로 지정하면 사용 가능</li>
</ul>
<pre class=" language-python"><code class="language-python">rf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>oob_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
rf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rf<span class="token punctuation">.</span>oob_score_<span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8934000384837406
</code></pre>
<h1 id="그레이디언트-부스팅"><a href="#그레이디언트-부스팅" class="headerlink" title="그레이디언트 부스팅"></a>그레이디언트 부스팅</h1><ul>
<li>이전 트리의 오차를 보완하는 방식으로 사용</li>
<li>깊이가 얕은 트리를 사용</li>
<li>학습을 매개변수로 속도를 조정</li>
<li>단점 : 속도가 느림</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> GradientBoostingClassifier
gb <span class="token operator">=</span> GradientBoostingClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>gb<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                        return_train_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'train_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8881086892152563 0.8720430147331015
</code></pre>
<pre class=" language-python"><code class="language-python">gb <span class="token operator">=</span> GradientBoostingClassifier<span class="token punctuation">(</span>n_estimators <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span> learning_rate <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>gb<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                        return_train_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'train_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.9464595437171814 0.8780082549788999
</code></pre>
<ul>
<li>흐름<ul>
<li><ol start="0">
<li>데이터 전처리 &#x2F; 시각화</li>
</ol>
</li>
<li><ol>
<li>기본 모형으로 전체 흐름을 설계</li>
</ol>
</li>
<li><ol start="2">
<li>여러 모형으로 비교 대조</li>
</ol>
</li>
<li><ol start="3">
<li>교차 검증, 하피어파라미터 성능 비교</li>
</ol>
</li>
<li>…</li>
<li>1등하는 그날까지</li>
</ul>
</li>
</ul>
<h1 id="히스토그램-기반-그레이디언트-부스팅"><a href="#히스토그램-기반-그레이디언트-부스팅" class="headerlink" title="히스토그램 기반 그레이디언트 부스팅"></a>히스토그램 기반 그레이디언트 부스팅</h1><ul>
<li>정형 데이터를 다루는 머신러닝 알고리즘 중 가장 인기가 높은 알고리즘</li>
<li>입력 특성을 256개 구간으로 나눔<ul>
<li>노드를 분할할 때 최적의 분할을 매우 빠르게 찾을 수 있음</li>
</ul>
</li>
<li>256개의 구간 중에서 하나를 떼어 놓고 누락된 값을 위해서 사용<ul>
<li>입력에 누락된 특성이 있더라도 이를 따로 전처리할 필요가 없음</li>
</ul>
</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>experimental <span class="token keyword">import</span> enable_hist_gradient_boosting
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> HistGradientBoostingClassifier
hgb <span class="token operator">=</span> HistGradientBoostingClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>hgb<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                        return_train_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'train_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.9321723946453317 0.8801241948619236
</code></pre>
<ul>
<li>특성 중요도 확인</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>inspection <span class="token keyword">import</span> permutation_importance

hgb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">)</span>
result <span class="token operator">=</span> permutation_importance<span class="token punctuation">(</span>hgb<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                                n_repeats <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>importances_mean<span class="token punctuation">)</span>
</code></pre>
<pre><code>[0.08876275 0.23438522 0.08027708]
</code></pre>
<ul>
<li>테스트 세트의 특성 중요도 확인</li>
</ul>
<pre class=" language-python"><code class="language-python">result <span class="token operator">=</span> permutation_importance<span class="token punctuation">(</span>hgb<span class="token punctuation">,</span> test_input<span class="token punctuation">,</span> test_target<span class="token punctuation">,</span>
                                n_repeats <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>importances_mean<span class="token punctuation">)</span>
</code></pre>
<pre><code>[0.05969231 0.20238462 0.049     ]
</code></pre>
<ul>
<li>테스트 세트의 성능 확인</li>
</ul>
<pre class=" language-python"><code class="language-python">hgb<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_input<span class="token punctuation">,</span> test_target<span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8723076923076923
</code></pre>
<h1 id="XGBoost"><a href="#XGBoost" class="headerlink" title="XGBoost"></a>XGBoost</h1><ul>
<li>그레디언트 부스팅 알고리즘을 구현한 라이브러리</li>
</ul>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> xgboost <span class="token keyword">import</span> XGBClassifier
xgb <span class="token operator">=</span> XGBClassifier<span class="token punctuation">(</span>tree_method <span class="token operator">=</span> <span class="token string">'hist'</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>xgb<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                        return_train_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'train_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.8824322471423747 0.8726214185237284
</code></pre>
<h1 id="LightGBM"><a href="#LightGBM" class="headerlink" title="LightGBM"></a>LightGBM</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> lightgbm <span class="token keyword">import</span> LGBMClassifier
lgb <span class="token operator">=</span> LGBMClassifier<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>
scores <span class="token operator">=</span> cross_validate<span class="token punctuation">(</span>lgb<span class="token punctuation">,</span> train_input<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span>
                        return_train_score <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> n_jobs <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'train_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">'test_score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre><code>0.9338079582727165 0.8789710890649293
</code></pre>
<h1 id="마무리-2"><a href="#마무리-2" class="headerlink" title="마무리"></a>마무리</h1><h2 id="키워드로-끝내는-핵심-포인트-2"><a href="#키워드로-끝내는-핵심-포인트-2" class="headerlink" title="키워드로 끝내는 핵심 포인트"></a>키워드로 끝내는 핵심 포인트</h2><ul>
<li><strong>앙상블 학습</strong>은 더 좋은 예측 결과를 만들기 위해 여러 개의 모델을 훈련하는 머신러닝 알고리즘을 말합니다.</li>
<li><strong>랜덤 포레스트</strong>는 대표적인 결정 트리 기반의 앙상블 학습 방법입니다. 부트스트랩 샘플을 사용하고 랜덤하게 일부 특성을 선택하여 트리를 만드는 것이 특징입니다.</li>
<li><strong>엑스트라 트리</strong>는 랜덤 포레스트와 비슷하게 결정 트리를 사용하여 앙상블 모델을 만들지만 부트스트랩 샘플을 사용하지 않습니다. 대신 랜덤하게 노드를 분할해 과대적합을 감소시킵니다.</li>
<li><strong>그레이디언트 부스팅</strong>은 랜덤 포레스트나 엑스트라 트리와 달리 결정 트리를 연속적으로 추가하여 손실 함수를 최소화하는 앙상블 방법입니다. 이런 이유로 훈련 속도가 조금 느리지만 더 좋은 성능을 기대할 수 있습니다. 그레이디언트 부스팅의 속도를 개선한 것이 <strong>히스토그램 기반 그레이디언트 부스팅</strong>이며 안정적인 결과와 높은 성능으로 매우 인기가 높습니다</li>
</ul>
<h2 id="핵심-패키지와-함수-2"><a href="#핵심-패키지와-함수-2" class="headerlink" title="핵심 패키지와 함수"></a>핵심 패키지와 함수</h2><h3 id="scikit-learn-2"><a href="#scikit-learn-2" class="headerlink" title="scikit-learn"></a>scikit-learn</h3><ul>
<li><p><strong>RandomForestClassifier</strong>는 랜덤 포레스트 분류 클래스입니다.</p>
<ul>
<li>n_estimators 매개변수는 앙상블을 구성할 트리의 개수를 지정합니다. 기본값은 100입니다.</li>
<li>criterion 매개변수는 불순도를 지정하며 기본값은 지니 불순도를 의미하는 ‘gini’이고 ‘entropy’를 선택하여 엔트로피 불순도를 사용할 수 있습니다.</li>
<li>max_depth는 트리가 성장할 최대 깊이를 지정합니다. 기본값은 None으로 지정하면 리프노드가 순수하거나 min_samples_split보다 샘플 개수가 적을 때까지 성장합니다.</li>
<li>min_samples_split은 노드를 나누기 위한 최소 샘플의 개수입니다. 기본값은 2입니다.</li>
<li>max_features 매개변수는 최적의 분할을 위해 탐색할 특성의 개수를 지정합니다. 기본값은 auto로 특성 개수의 제곱근입니다.</li>
<li>bootstrap 매개변수는 부트스트랩 샘플을 사용할지 지정합니다. 기본값은 True입니다.</li>
<li>oob_score는 OOB 샘플을 사용하여 훈련한 모델을 평가할지 지정합니다. 기본값은 False입니다.</li>
<li>n_jobs 매개변수는 병렬 실행에 사용할 CPU 코어 수를 지정합니다. 기본값은 1로 하나의 코어를 사용합니다. -1로 지정하면 시스템에 있는 모든 코어를 사용합니다.</li>
</ul>
</li>
<li><p><strong>ExtraTreesClassifier</strong>는 엑스트라 트리 분류 클래스입니다.</p>
<ul>
<li>n_estimators, criterion, max_depth, min_samples_split, max_features 매개변수는 랜덤 포레스트와 동일합니다.</li>
<li>bootstrap 매개변수는 부트스트랩 샘플을 사용할지 지정합니다. 기본값은 False입니다.</li>
<li>oob_score는 OOB 샘플을 사용하여 훈련한 모델을 평가할지 지정합니다. 기본값은 False입니다.</li>
<li>n_jobs 매개변수는 병렬 실행에 사용할 CPU 코어 수를 지정합니다. 기본값은 1로 하나의 코어를 사용합니다. -1로 지정하면 시스템에 있는 모든 코어를 사용합니다.</li>
</ul>
</li>
<li><p><strong>GradientBoostingClassifier</strong>는 그레이디언트 부스팅 분류 클래스입니다.</p>
<ul>
<li>loss 매개변수는 손실 함수를 지정합니다. 기본값은 로지스틱 손실 함수를 의미하는’deviance’입니다.</li>
<li>learning_rate 매개변수는 트리가 앙상블에 기여하는 정도를 조절합니다. 기본값은 0.1입니다.</li>
<li>n_estimators 매개변수는 부스팅 단계를 수행하는 트리의 개수입니다. 기본값은 100입니다.</li>
<li>subsample 매개변수는 사용할 훈련 세트의 샘플 비율을 지정합니다. 기본값은 1.0입니다.</li>
<li>max_depth 매개변수는 개별 회귀 트리의 최대 깊이입니다. 기본값은 3입니다.</li>
</ul>
</li>
<li><p><strong>HistGradientBoostingClassifier</strong>는 히스토그램 기반 그레이디언트 부스팅 분류 클래스입니다.</p>
<ul>
<li>learning_rate 매개변수는 학습률 또는 감쇠율이라고 합니다. 기본값은 0.1이며 1.0이면 감쇠가 전혀 없습니다.</li>
<li>max_iter는 부스팅 단계를 수행하는 트리의 개수입니다. 기본값은 100입니다.</li>
<li>max_bins는 입력 데이터를 나눌 구간의 개수입니다. 기본값은 255이며 이보다 크게 지정할 수 없습니다. 여기에 1개의 구간이 누락된 값을 위해 추가됩니다.</li>
</ul>
</li>
</ul>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/klugjo/hexo-theme-clean-blog" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2022 SiriN<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>